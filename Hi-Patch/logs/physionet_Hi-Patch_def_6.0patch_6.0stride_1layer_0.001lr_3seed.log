/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-29 18:31:31
train_forecasting.py --dataset physionet --state def --history 24 --patience 10 --batch_size 64 --lr 1e-3 --patch_size 6 --stride 6 --nhead 1 --nlayer 1 --hid_dim 64 --seed 3 --gpu 0 --alpha 1
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=24, pred_window=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=64, load=None, seed=3, dataset='physionet', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=1, patch_size=6.0, stride=6.0, hid_dim=64, alpha=1.0, res=1, gpu='0', npatch=4, device=device(type='cuda', index=0), PID=1029906, ndim=41, patch_layer=3, scale_patch_size=0.125, task='forecasting')
- Epoch 000, ExpID 606
Train - Loss (one batch): 0.00529
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00695, 0.00695, 0.08335, 0.04568, 138.95%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00697, 0.00697, 0.08347, 0.04583, 137.90%
Time spent: 41.17s
- Epoch 001, ExpID 606
Train - Loss (one batch): 0.00425
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00647, 0.00647, 0.08045, 0.04213, 143.76%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00616, 0.00616, 0.07849, 0.04183, 137.08%
Time spent: 40.76s
- Epoch 002, ExpID 606
Train - Loss (one batch): 0.00378
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00620, 0.00620, 0.07874, 0.03964, 114.67%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 2, 0.00597, 0.00597, 0.07726, 0.03942, 108.41%
Time spent: 40.78s
- Epoch 003, ExpID 606
Train - Loss (one batch): 0.00414
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00607, 0.00607, 0.07792, 0.04037, 140.44%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00590, 0.00590, 0.07679, 0.04057, 135.69%
Time spent: 40.78s
- Epoch 004, ExpID 606
Train - Loss (one batch): 0.00486
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00592, 0.00592, 0.07692, 0.03878, 114.90%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.00588, 0.00588, 0.07666, 0.03936, 116.73%
Time spent: 40.73s
- Epoch 005, ExpID 606
Train - Loss (one batch): 0.00467
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00604, 0.00604, 0.07772, 0.03782, 67.39%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.00588, 0.00588, 0.07666, 0.03936, 116.73%
Time spent: 34.13s
- Epoch 006, ExpID 606
Train - Loss (one batch): 0.00511
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00619, 0.00619, 0.07866, 0.03951, 105.77%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.00588, 0.00588, 0.07666, 0.03936, 116.73%
Time spent: 34.21s
- Epoch 007, ExpID 606
Train - Loss (one batch): 0.00472
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00619, 0.00619, 0.07867, 0.03802, 82.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.00588, 0.00588, 0.07666, 0.03936, 116.73%
Time spent: 34.16s
- Epoch 008, ExpID 606
Train - Loss (one batch): 0.00367
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00586, 0.00586, 0.07653, 0.03762, 95.34%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00570, 0.00570, 0.07548, 0.03791, 97.27%
Time spent: 40.80s
- Epoch 009, ExpID 606
Train - Loss (one batch): 0.00379
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00630, 0.00630, 0.07939, 0.04379, 167.32%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00570, 0.00570, 0.07548, 0.03791, 97.27%
Time spent: 34.11s
- Epoch 010, ExpID 606
Train - Loss (one batch): 0.00364
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00590, 0.00590, 0.07682, 0.03810, 97.50%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00570, 0.00570, 0.07548, 0.03791, 97.27%
Time spent: 34.11s
- Epoch 011, ExpID 606
Train - Loss (one batch): 0.00456
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00575, 0.00575, 0.07581, 0.03846, 148.80%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 40.77s
- Epoch 012, ExpID 606
Train - Loss (one batch): 0.00403
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00600, 0.00600, 0.07747, 0.04057, 144.81%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.21s
- Epoch 013, ExpID 606
Train - Loss (one batch): 0.00594
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00590, 0.00590, 0.07684, 0.03858, 65.53%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.17s
- Epoch 014, ExpID 606
Train - Loss (one batch): 0.00339
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00598, 0.00598, 0.07730, 0.04138, 164.61%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.09s
- Epoch 015, ExpID 606
Train - Loss (one batch): 0.00533
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00603, 0.00603, 0.07764, 0.03806, 89.75%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.17s
- Epoch 016, ExpID 606
Train - Loss (one batch): 0.00268
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00596, 0.00596, 0.07721, 0.03928, 120.22%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.23s
- Epoch 017, ExpID 606
Train - Loss (one batch): 0.00349
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00597, 0.00597, 0.07724, 0.03791, 100.29%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.23s
- Epoch 018, ExpID 606
Train - Loss (one batch): 0.00619
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00584, 0.00584, 0.07642, 0.03983, 96.40%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.19s
- Epoch 019, ExpID 606
Train - Loss (one batch): 0.00494
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00609, 0.00609, 0.07802, 0.03928, 72.50%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.16s
- Epoch 020, ExpID 606
Train - Loss (one batch): 0.00325
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00606, 0.00606, 0.07785, 0.03950, 71.33%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.07s
- Epoch 021, ExpID 606
Train - Loss (one batch): 0.00440
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00580, 0.00580, 0.07615, 0.03826, 61.45%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00581, 0.00581, 0.07624, 0.03932, 151.20%
Time spent: 34.12s
Avg Train Time per epoch: 27.83s
Avg Inference Time per epoch: 0.14865s
Avg Peak GPU Mem (Train): 12745.5 MB
Peak GPU Mem (Inference): 10770.1 MB
