/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-29 14:17:02
train_forecasting.py --dataset physionet --state def --history 24 --patience 10 --batch_size 32 --lr 1e-3 --patch_size 6 --stride 6 --nhead 1 --nlayer 1 --hid_dim 64 --seed 3 --gpu 0 --alpha 1
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=24, pred_window=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=32, load=None, seed=3, dataset='physionet', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=1, patch_size=6.0, stride=6.0, hid_dim=64, alpha=1.0, res=1, gpu='0', npatch=4, device=device(type='cuda', index=0), PID=1020464, ndim=41, patch_layer=3, scale_patch_size=0.125, task='forecasting')
- Epoch 000, ExpID 6715
Train - Loss (one batch): 0.00513
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00690, 0.00690, 0.08305, 0.04458, 88.46%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00674, 0.00674, 0.08212, 0.04469, 86.97%
Time spent: 41.95s
- Epoch 001, ExpID 6715
Train - Loss (one batch): 0.00416
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00635, 0.00635, 0.07971, 0.04213, 124.10%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00616, 0.00616, 0.07849, 0.04210, 120.64%
Time spent: 41.46s
- Epoch 002, ExpID 6715
Train - Loss (one batch): 0.00390
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00595, 0.00595, 0.07713, 0.03833, 76.09%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 2, 0.00581, 0.00581, 0.07620, 0.03825, 75.60%
Time spent: 41.59s
- Epoch 003, ExpID 6715
Train - Loss (one batch): 0.00395
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00590, 0.00590, 0.07681, 0.03803, 92.33%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00578, 0.00578, 0.07601, 0.03825, 89.74%
Time spent: 41.48s
- Epoch 004, ExpID 6715
Train - Loss (one batch): 0.00478
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00644, 0.00644, 0.08024, 0.04736, 181.55%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00578, 0.00578, 0.07601, 0.03825, 89.74%
Time spent: 35.00s
- Epoch 005, ExpID 6715
Train - Loss (one batch): 0.00278
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00588, 0.00588, 0.07666, 0.03870, 125.80%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00579, 0.00579, 0.07612, 0.03925, 136.90%
Time spent: 41.51s
- Epoch 006, ExpID 6715
Train - Loss (one batch): 0.00501
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00609, 0.00609, 0.07804, 0.03857, 69.65%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00579, 0.00579, 0.07612, 0.03925, 136.90%
Time spent: 35.01s
- Epoch 007, ExpID 6715
Train - Loss (one batch): 0.00482
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00605, 0.00605, 0.07778, 0.03764, 97.86%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00579, 0.00579, 0.07612, 0.03925, 136.90%
Time spent: 35.02s
- Epoch 008, ExpID 6715
Train - Loss (one batch): 0.00388
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00605, 0.00605, 0.07780, 0.03983, 120.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00579, 0.00579, 0.07612, 0.03925, 136.90%
Time spent: 35.04s
- Epoch 009, ExpID 6715
Train - Loss (one batch): 0.00387
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00587, 0.00587, 0.07659, 0.03811, 97.53%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 9, 0.00566, 0.00566, 0.07522, 0.03847, 103.31%
Time spent: 41.51s
- Epoch 010, ExpID 6715
Train - Loss (one batch): 0.00366
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00594, 0.00594, 0.07707, 0.03814, 83.60%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 9, 0.00566, 0.00566, 0.07522, 0.03847, 103.31%
Time spent: 35.01s
- Epoch 011, ExpID 6715
Train - Loss (one batch): 0.00454
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00577, 0.00577, 0.07593, 0.03769, 89.83%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00567, 0.00567, 0.07532, 0.03824, 92.00%
Time spent: 41.50s
- Epoch 012, ExpID 6715
Train - Loss (one batch): 0.00384
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00579, 0.00579, 0.07612, 0.03722, 71.12%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00567, 0.00567, 0.07532, 0.03824, 92.00%
Time spent: 35.02s
- Epoch 013, ExpID 6715
Train - Loss (one batch): 0.00596
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00575, 0.00575, 0.07584, 0.03767, 89.35%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00570, 0.00570, 0.07551, 0.03803, 93.93%
Time spent: 41.55s
- Epoch 014, ExpID 6715
Train - Loss (one batch): 0.00349
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00602, 0.00602, 0.07757, 0.03739, 64.97%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00570, 0.00570, 0.07551, 0.03803, 93.93%
Time spent: 35.02s
- Epoch 015, ExpID 6715
Train - Loss (one batch): 0.00277
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00582, 0.00582, 0.07631, 0.03734, 75.87%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00570, 0.00570, 0.07551, 0.03803, 93.93%
Time spent: 35.03s
- Epoch 016, ExpID 6715
Train - Loss (one batch): 0.00288
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00596, 0.00596, 0.07722, 0.03820, 80.24%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00570, 0.00570, 0.07551, 0.03803, 93.93%
Time spent: 35.04s
- Epoch 017, ExpID 6715
Train - Loss (one batch): 0.00476
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00598, 0.00598, 0.07736, 0.03901, 66.74%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00570, 0.00570, 0.07551, 0.03803, 93.93%
Time spent: 34.97s
- Epoch 018, ExpID 6715
Train - Loss (one batch): 0.00409
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00625, 0.00625, 0.07908, 0.03952, 64.30%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00570, 0.00570, 0.07551, 0.03803, 93.93%
Time spent: 35.00s
- Epoch 019, ExpID 6715
Train - Loss (one batch): 0.00471
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00602, 0.00602, 0.07759, 0.03722, 82.78%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00570, 0.00570, 0.07551, 0.03803, 93.93%
Time spent: 35.00s
- Epoch 020, ExpID 6715
Train - Loss (one batch): 0.00376
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00592, 0.00592, 0.07691, 0.03763, 62.27%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00570, 0.00570, 0.07551, 0.03803, 93.93%
Time spent: 35.00s
- Epoch 021, ExpID 6715
Train - Loss (one batch): 0.00468
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00573, 0.00573, 0.07572, 0.03725, 83.88%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 21, 0.00565, 0.00565, 0.07515, 0.03746, 94.90%
Time spent: 41.52s
- Epoch 022, ExpID 6715
Train - Loss (one batch): 0.00508
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00595, 0.00595, 0.07711, 0.03789, 108.76%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 21, 0.00565, 0.00565, 0.07515, 0.03746, 94.90%
Time spent: 34.99s
- Epoch 023, ExpID 6715
Train - Loss (one batch): 0.00585
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00582, 0.00582, 0.07626, 0.03752, 142.76%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 21, 0.00565, 0.00565, 0.07515, 0.03746, 94.90%
Time spent: 35.04s
- Epoch 024, ExpID 6715
Train - Loss (one batch): 0.00391
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00593, 0.00593, 0.07701, 0.03842, 102.05%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 21, 0.00565, 0.00565, 0.07515, 0.03746, 94.90%
Time spent: 35.04s
- Epoch 025, ExpID 6715
Train - Loss (one batch): 0.00279
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00606, 0.00606, 0.07783, 0.03841, 52.19%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 21, 0.00565, 0.00565, 0.07515, 0.03746, 94.90%
Time spent: 35.04s
- Epoch 026, ExpID 6715
Train - Loss (one batch): 0.00324
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00604, 0.00604, 0.07772, 0.03876, 64.40%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 21, 0.00565, 0.00565, 0.07515, 0.03746, 94.90%
Time spent: 35.02s
- Epoch 027, ExpID 6715
Train - Loss (one batch): 0.00428
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00577, 0.00577, 0.07594, 0.03666, 68.73%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 21, 0.00565, 0.00565, 0.07515, 0.03746, 94.90%
Time spent: 35.04s
- Epoch 028, ExpID 6715
Train - Loss (one batch): 0.00305
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00588, 0.00588, 0.07665, 0.03711, 92.49%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 21, 0.00565, 0.00565, 0.07515, 0.03746, 94.90%
Time spent: 34.98s
- Epoch 029, ExpID 6715
Train - Loss (one batch): 0.00571
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00573, 0.00573, 0.07567, 0.03701, 71.94%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 41.51s
- Epoch 030, ExpID 6715
Train - Loss (one batch): 0.00393
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00582, 0.00582, 0.07631, 0.03754, 90.68%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 35.00s
- Epoch 031, ExpID 6715
Train - Loss (one batch): 0.00450
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00597, 0.00597, 0.07729, 0.03743, 64.66%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 34.98s
- Epoch 032, ExpID 6715
Train - Loss (one batch): 0.00349
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00585, 0.00585, 0.07651, 0.03745, 80.39%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 34.97s
- Epoch 033, ExpID 6715
Train - Loss (one batch): 0.00372
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00602, 0.00602, 0.07760, 0.03864, 80.12%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 35.03s
- Epoch 034, ExpID 6715
Train - Loss (one batch): 0.00376
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00611, 0.00611, 0.07817, 0.03904, 56.39%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 34.97s
- Epoch 035, ExpID 6715
Train - Loss (one batch): 0.00312
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00592, 0.00592, 0.07692, 0.03665, 78.01%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 35.06s
- Epoch 036, ExpID 6715
Train - Loss (one batch): 0.00411
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00577, 0.00577, 0.07599, 0.03711, 91.65%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 34.97s
- Epoch 037, ExpID 6715
Train - Loss (one batch): 0.00333
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00606, 0.00606, 0.07783, 0.03743, 61.48%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 34.98s
- Epoch 038, ExpID 6715
Train - Loss (one batch): 0.00420
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00597, 0.00597, 0.07726, 0.03747, 79.85%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 34.97s
- Epoch 039, ExpID 6715
Train - Loss (one batch): 0.00323
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00610, 0.00610, 0.07810, 0.03801, 104.00%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00548, 0.00548, 0.07400, 0.03694, 76.60%
Time spent: 34.97s
Avg Train Time per epoch: 28.64s
Avg Inference Time per epoch: 0.07647s
Avg Peak GPU Mem (Train): 7009.6 MB
Peak GPU Mem (Inference): 5871.9 MB
