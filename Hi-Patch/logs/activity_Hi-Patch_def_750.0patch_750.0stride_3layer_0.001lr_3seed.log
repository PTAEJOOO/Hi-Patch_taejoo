/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-29 19:24:34
train_forecasting.py --dataset activity --state def --history 3000 --patience 10 --batch_size 32 --lr 1e-3 --patch_size 750 --stride 750 --nhead 1 --nlayer 3 --hid_dim 64 --seed 3 --gpu 0 --alpha 1
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=3000, pred_window=1000, logmode='a', lr=0.001, w_decay=0.0, batch_size=32, load=None, seed=3, dataset='activity', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=3, patch_size=750.0, stride=750.0, hid_dim=64, alpha=1.0, res=1, gpu='0', npatch=4, device=device(type='cuda', index=0), PID=1030656, ndim=12, patch_layer=3, scale_patch_size=0.1875, task='forecasting')
- Epoch 000, ExpID 74992
Train - Loss (one batch): 0.00279
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00334, 0.00334, 0.05779, 0.03595, 9.21%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00318, 0.00318, 0.05640, 0.03520, 8.06%
Time spent: 43.19s
- Epoch 001, ExpID 74992
Train - Loss (one batch): 0.00267
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00310, 0.00310, 0.05566, 0.03368, 8.66%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00297, 0.00297, 0.05452, 0.03343, 7.70%
Time spent: 42.76s
- Epoch 002, ExpID 74992
Train - Loss (one batch): 0.00420
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00330, 0.00330, 0.05746, 0.03773, 9.95%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00297, 0.00297, 0.05452, 0.03343, 7.70%
Time spent: 36.38s
- Epoch 003, ExpID 74992
Train - Loss (one batch): 0.00218
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00294, 0.00294, 0.05426, 0.03301, 8.54%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00283, 0.00283, 0.05318, 0.03271, 7.57%
Time spent: 42.76s
- Epoch 004, ExpID 74992
Train - Loss (one batch): 0.00307
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00290, 0.00290, 0.05389, 0.03245, 8.43%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.00279, 0.00279, 0.05283, 0.03212, 7.45%
Time spent: 42.75s
- Epoch 005, ExpID 74992
Train - Loss (one batch): 0.00229
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00293, 0.00293, 0.05416, 0.03302, 8.50%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.00279, 0.00279, 0.05283, 0.03212, 7.45%
Time spent: 36.39s
- Epoch 006, ExpID 74992
Train - Loss (one batch): 0.00242
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00285, 0.00285, 0.05336, 0.03259, 8.48%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.00277, 0.00277, 0.05264, 0.03238, 7.54%
Time spent: 42.76s
- Epoch 007, ExpID 74992
Train - Loss (one batch): 0.00316
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00285, 0.00285, 0.05335, 0.03238, 8.44%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00277, 0.00277, 0.05261, 0.03235, 7.52%
Time spent: 42.68s
- Epoch 008, ExpID 74992
Train - Loss (one batch): 0.00253
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00290, 0.00290, 0.05387, 0.03355, 8.34%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00277, 0.00277, 0.05261, 0.03235, 7.52%
Time spent: 36.39s
- Epoch 009, ExpID 74992
Train - Loss (one batch): 0.00180
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00302, 0.00302, 0.05498, 0.03568, 9.30%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00277, 0.00277, 0.05261, 0.03235, 7.52%
Time spent: 36.42s
- Epoch 010, ExpID 74992
Train - Loss (one batch): 0.00226
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00307, 0.00307, 0.05541, 0.03623, 8.84%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00277, 0.00277, 0.05261, 0.03235, 7.52%
Time spent: 36.43s
- Epoch 011, ExpID 74992
Train - Loss (one batch): 0.00438
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00283, 0.00283, 0.05321, 0.03320, 8.87%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00277, 0.00277, 0.05259, 0.03294, 7.81%
Time spent: 42.81s
- Epoch 012, ExpID 74992
Train - Loss (one batch): 0.00262
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00278, 0.00278, 0.05277, 0.03248, 8.23%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 12, 0.00274, 0.00274, 0.05230, 0.03262, 7.38%
Time spent: 42.81s
- Epoch 013, ExpID 74992
Train - Loss (one batch): 0.00264
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00276, 0.00276, 0.05250, 0.03203, 8.24%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00272, 0.00272, 0.05212, 0.03194, 7.36%
Time spent: 42.81s
- Epoch 014, ExpID 74992
Train - Loss (one batch): 0.00231
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00285, 0.00285, 0.05343, 0.03403, 8.37%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00272, 0.00272, 0.05212, 0.03194, 7.36%
Time spent: 36.43s
- Epoch 015, ExpID 74992
Train - Loss (one batch): 0.00237
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00271, 0.00271, 0.05201, 0.03137, 8.00%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 15, 0.00264, 0.00264, 0.05136, 0.03131, 7.17%
Time spent: 42.81s
- Epoch 016, ExpID 74992
Train - Loss (one batch): 0.00222
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00270, 0.00270, 0.05194, 0.03185, 8.27%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 16, 0.00266, 0.00266, 0.05154, 0.03186, 7.48%
Time spent: 42.81s
- Epoch 017, ExpID 74992
Train - Loss (one batch): 0.00143
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00267, 0.00267, 0.05166, 0.03105, 7.94%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 17, 0.00264, 0.00264, 0.05141, 0.03123, 7.13%
Time spent: 42.80s
- Epoch 018, ExpID 74992
Train - Loss (one batch): 0.00283
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00278, 0.00278, 0.05272, 0.03331, 8.29%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 17, 0.00264, 0.00264, 0.05141, 0.03123, 7.13%
Time spent: 36.41s
- Epoch 019, ExpID 74992
Train - Loss (one batch): 0.00173
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00281, 0.00281, 0.05305, 0.03354, 8.80%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 17, 0.00264, 0.00264, 0.05141, 0.03123, 7.13%
Time spent: 36.42s
- Epoch 020, ExpID 74992
Train - Loss (one batch): 0.00207
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00270, 0.00270, 0.05194, 0.03188, 8.20%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 17, 0.00264, 0.00264, 0.05141, 0.03123, 7.13%
Time spent: 36.42s
- Epoch 021, ExpID 74992
Train - Loss (one batch): 0.00300
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00268, 0.00268, 0.05177, 0.03164, 8.25%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 17, 0.00264, 0.00264, 0.05141, 0.03123, 7.13%
Time spent: 36.42s
- Epoch 022, ExpID 74992
Train - Loss (one batch): 0.00221
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00266, 0.00266, 0.05153, 0.03121, 8.15%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 42.78s
- Epoch 023, ExpID 74992
Train - Loss (one batch): 0.00232
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00268, 0.00268, 0.05176, 0.03167, 8.29%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.41s
- Epoch 024, ExpID 74992
Train - Loss (one batch): 0.00186
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00271, 0.00271, 0.05206, 0.03172, 8.05%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.41s
- Epoch 025, ExpID 74992
Train - Loss (one batch): 0.00202
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00267, 0.00267, 0.05164, 0.03154, 8.00%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.44s
- Epoch 026, ExpID 74992
Train - Loss (one batch): 0.00281
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00266, 0.00266, 0.05154, 0.03157, 8.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.45s
- Epoch 027, ExpID 74992
Train - Loss (one batch): 0.00185
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00269, 0.00269, 0.05190, 0.03194, 8.12%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.42s
- Epoch 028, ExpID 74992
Train - Loss (one batch): 0.00260
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00270, 0.00270, 0.05199, 0.03226, 8.15%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.43s
- Epoch 029, ExpID 74992
Train - Loss (one batch): 0.00409
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00270, 0.00270, 0.05193, 0.03209, 8.50%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.43s
- Epoch 030, ExpID 74992
Train - Loss (one batch): 0.00263
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00267, 0.00267, 0.05165, 0.03176, 8.04%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.59s
- Epoch 031, ExpID 74992
Train - Loss (one batch): 0.00186
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00295, 0.00295, 0.05429, 0.03566, 8.59%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.57s
- Epoch 032, ExpID 74992
Train - Loss (one batch): 0.00235
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00275, 0.00275, 0.05249, 0.03292, 8.50%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00261, 0.00261, 0.05107, 0.03131, 7.28%
Time spent: 36.70s
Avg Train Time per epoch: 30.49s
Avg Inference Time per epoch: 0.17985s
Avg Peak GPU Mem (Train): 5370.1 MB
Peak GPU Mem (Inference): 3398.7 MB
