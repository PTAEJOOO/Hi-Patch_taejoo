/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-29 15:39:52
train_forecasting.py --dataset mimic --state def --history 24 --patience 10 --batch_size 8 --lr 1e-3 --patch_size 12 --stride 12 --nhead 1 --nlayer 1 --hid_dim 128 --seed 1 --gpu 0 --alpha 0.9
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=24, pred_window=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=8, load=None, seed=1, dataset='mimic', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=1, patch_size=12.0, stride=12.0, hid_dim=128, alpha=0.9, res=1, gpu='0', npatch=2, device=device(type='cuda', index=0), PID=1025099, ndim=96, patch_layer=2, scale_patch_size=0.25, task='forecasting')
- Epoch 000, ExpID 74317
Train - Loss (one batch): 0.00251
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01579, 0.01579, 0.12564, 0.07320, 118.93%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.01700, 0.01700, 0.13039, 0.07445, 136.94%
Time spent: 99.09s
- Epoch 001, ExpID 74317
Train - Loss (one batch): 0.00421
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01560, 0.01560, 0.12490, 0.07616, 116.86%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.01667, 0.01667, 0.12913, 0.07706, 144.36%
Time spent: 98.89s
- Epoch 002, ExpID 74317
Train - Loss (one batch): 0.00071
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01521, 0.01521, 0.12333, 0.07385, 142.11%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 2, 0.01632, 0.01632, 0.12773, 0.07438, 160.10%
Time spent: 99.12s
- Epoch 003, ExpID 74317
Train - Loss (one batch): 0.00484
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01521, 0.01521, 0.12332, 0.07131, 88.47%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01626, 0.01626, 0.12753, 0.07166, 112.62%
Time spent: 99.00s
- Epoch 004, ExpID 74317
Train - Loss (one batch): 0.00117
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01486, 0.01486, 0.12189, 0.06952, 90.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.01605, 0.01605, 0.12668, 0.07020, 113.91%
Time spent: 98.88s
- Epoch 005, ExpID 74317
Train - Loss (one batch): 0.00173
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01522, 0.01522, 0.12335, 0.07344, 99.66%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.01605, 0.01605, 0.12668, 0.07020, 113.91%
Time spent: 84.15s
- Epoch 006, ExpID 74317
Train - Loss (one batch): 0.00065
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01484, 0.01484, 0.12183, 0.06838, 87.14%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 98.74s
- Epoch 007, ExpID 74317
Train - Loss (one batch): 0.00372
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01512, 0.01512, 0.12298, 0.06993, 105.55%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.36s
- Epoch 008, ExpID 74317
Train - Loss (one batch): 0.01199
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01537, 0.01537, 0.12397, 0.07481, 113.58%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.43s
- Epoch 009, ExpID 74317
Train - Loss (one batch): 0.00078
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01486, 0.01486, 0.12190, 0.06870, 84.66%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.32s
- Epoch 010, ExpID 74317
Train - Loss (one batch): 0.00605
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01511, 0.01511, 0.12292, 0.06960, 112.19%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.32s
- Epoch 011, ExpID 74317
Train - Loss (one batch): 0.01570
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01552, 0.01552, 0.12457, 0.07253, 104.66%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.46s
- Epoch 012, ExpID 74317
Train - Loss (one batch): 0.00141
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01512, 0.01512, 0.12296, 0.07047, 111.25%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.42s
- Epoch 013, ExpID 74317
Train - Loss (one batch): 0.00060
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01524, 0.01524, 0.12346, 0.06945, 112.34%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.39s
- Epoch 014, ExpID 74317
Train - Loss (one batch): 0.00458
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01505, 0.01505, 0.12269, 0.06962, 87.36%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.33s
- Epoch 015, ExpID 74317
Train - Loss (one batch): 0.00843
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01508, 0.01508, 0.12279, 0.07072, 100.30%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.17s
- Epoch 016, ExpID 74317
Train - Loss (one batch): 0.00833
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01506, 0.01506, 0.12273, 0.06915, 88.79%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01596, 0.01596, 0.12633, 0.06893, 114.57%
Time spent: 84.29s
Avg Train Time per epoch: 69.90s
Avg Inference Time per epoch: 0.01993s
Avg Peak GPU Mem (Train): 11943.2 MB
Peak GPU Mem (Inference): 9294.4 MB
