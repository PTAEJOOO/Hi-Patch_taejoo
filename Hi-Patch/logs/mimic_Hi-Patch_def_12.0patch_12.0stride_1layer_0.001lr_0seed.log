/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-29 15:36:40
train_forecasting.py --dataset mimic --state def --history 24 --patience 10 --batch_size 8 --lr 1e-3 --patch_size 12 --stride 12 --nhead 1 --nlayer 1 --hid_dim 128 --seed 0 --gpu 0 --alpha 0.9
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=24, pred_window=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=8, load=None, seed=0, dataset='mimic', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=1, patch_size=12.0, stride=12.0, hid_dim=128, alpha=0.9, res=1, gpu='0', npatch=2, device=device(type='cuda', index=0), PID=1024983, ndim=96, patch_layer=2, scale_patch_size=0.25, task='forecasting')
- Epoch 000, ExpID 76698
Train - Loss (one batch): 0.00109
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01548, 0.01548, 0.12442, 0.07179, 95.71%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.01646, 0.01646, 0.12832, 0.07160, 107.29%
Time spent: 99.28s
- Epoch 001, ExpID 76698
Train - Loss (one batch): 0.00107
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01542, 0.01542, 0.12417, 0.06944, 99.18%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.01636, 0.01636, 0.12793, 0.06908, 117.33%
Time spent: 99.22s
- Epoch 002, ExpID 76698
Train - Loss (one batch): 0.00491
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01566, 0.01566, 0.12514, 0.07438, 131.69%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.01636, 0.01636, 0.12793, 0.06908, 117.33%
Time spent: 84.42s
- Epoch 003, ExpID 76698
Train - Loss (one batch): 0.01882
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01487, 0.01487, 0.12193, 0.06901, 124.54%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 99.06s
- Epoch 004, ExpID 76698
Train - Loss (one batch): 0.00114
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01587, 0.01587, 0.12596, 0.07070, 90.20%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.59s
- Epoch 005, ExpID 76698
Train - Loss (one batch): 0.00124
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01561, 0.01561, 0.12492, 0.07043, 91.04%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.41s
- Epoch 006, ExpID 76698
Train - Loss (one batch): 0.00853
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01514, 0.01514, 0.12306, 0.06963, 88.26%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.47s
- Epoch 007, ExpID 76698
Train - Loss (one batch): 0.00669
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01578, 0.01578, 0.12563, 0.07495, 119.85%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.56s
- Epoch 008, ExpID 76698
Train - Loss (one batch): 0.00285
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01535, 0.01535, 0.12390, 0.07039, 125.70%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.49s
- Epoch 009, ExpID 76698
Train - Loss (one batch): 0.00249
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01520, 0.01520, 0.12331, 0.07150, 106.12%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.43s
- Epoch 010, ExpID 76698
Train - Loss (one batch): 0.02398
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01514, 0.01514, 0.12303, 0.06995, 78.46%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.54s
- Epoch 011, ExpID 76698
Train - Loss (one batch): 0.00489
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01516, 0.01516, 0.12311, 0.06894, 97.71%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.44s
- Epoch 012, ExpID 76698
Train - Loss (one batch): 0.00168
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01520, 0.01520, 0.12328, 0.07326, 138.57%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.48s
- Epoch 013, ExpID 76698
Train - Loss (one batch): 0.00194
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01522, 0.01522, 0.12336, 0.06966, 103.67%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01627, 0.01627, 0.12754, 0.07023, 144.71%
Time spent: 84.50s
Avg Train Time per epoch: 70.03s
Avg Inference Time per epoch: 0.01996s
Avg Peak GPU Mem (Train): 11931.5 MB
Peak GPU Mem (Inference): 9294.4 MB
