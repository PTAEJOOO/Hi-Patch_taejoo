/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-29 14:41:47
train_forecasting.py --dataset physionet --state def --history 24 --patience 10 --batch_size 32 --lr 1e-3 --patch_size 6 --stride 6 --nhead 1 --nlayer 1 --hid_dim 64 --seed 4 --gpu 0 --alpha 1
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=24, pred_window=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=32, load=None, seed=4, dataset='physionet', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=1, patch_size=6.0, stride=6.0, hid_dim=64, alpha=1.0, res=1, gpu='0', npatch=4, device=device(type='cuda', index=0), PID=1020878, ndim=41, patch_layer=3, scale_patch_size=0.125, task='forecasting')
- Epoch 000, ExpID 77822
Train - Loss (one batch): 0.00454
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00667, 0.00667, 0.08166, 0.04266, 119.97%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00679, 0.00679, 0.08239, 0.04338, 127.14%
Time spent: 41.85s
- Epoch 001, ExpID 77822
Train - Loss (one batch): 0.00494
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00691, 0.00691, 0.08311, 0.04667, 200.02%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00679, 0.00679, 0.08239, 0.04338, 127.14%
Time spent: 35.00s
- Epoch 002, ExpID 77822
Train - Loss (one batch): 0.00558
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00634, 0.00634, 0.07965, 0.04388, 146.67%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 2, 0.00619, 0.00619, 0.07865, 0.04428, 155.33%
Time spent: 41.59s
- Epoch 003, ExpID 77822
Train - Loss (one batch): 0.00592
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00610, 0.00610, 0.07812, 0.03875, 102.63%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00591, 0.00591, 0.07686, 0.03910, 108.30%
Time spent: 41.51s
- Epoch 004, ExpID 77822
Train - Loss (one batch): 0.00670
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00630, 0.00630, 0.07936, 0.03918, 134.05%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00591, 0.00591, 0.07686, 0.03910, 108.30%
Time spent: 35.03s
- Epoch 005, ExpID 77822
Train - Loss (one batch): 0.00467
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00609, 0.00609, 0.07806, 0.03851, 118.66%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00591, 0.00591, 0.07685, 0.03876, 123.68%
Time spent: 41.62s
- Epoch 006, ExpID 77822
Train - Loss (one batch): 0.00434
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00674, 0.00674, 0.08207, 0.04452, 112.26%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00591, 0.00591, 0.07685, 0.03876, 123.68%
Time spent: 35.03s
- Epoch 007, ExpID 77822
Train - Loss (one batch): 0.00580
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00597, 0.00597, 0.07727, 0.03775, 95.63%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00570, 0.00570, 0.07549, 0.03767, 98.84%
Time spent: 41.60s
- Epoch 008, ExpID 77822
Train - Loss (one batch): 0.00445
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00578, 0.00578, 0.07603, 0.03756, 92.03%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 41.61s
- Epoch 009, ExpID 77822
Train - Loss (one batch): 0.00322
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00613, 0.00613, 0.07831, 0.03869, 89.82%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 35.08s
- Epoch 010, ExpID 77822
Train - Loss (one batch): 0.00480
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00614, 0.00614, 0.07838, 0.04054, 104.05%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 35.00s
- Epoch 011, ExpID 77822
Train - Loss (one batch): 0.00228
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00600, 0.00600, 0.07744, 0.03819, 88.78%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 35.07s
- Epoch 012, ExpID 77822
Train - Loss (one batch): 0.00316
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00610, 0.00610, 0.07811, 0.04116, 74.92%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 35.02s
- Epoch 013, ExpID 77822
Train - Loss (one batch): 0.00343
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00583, 0.00583, 0.07634, 0.03714, 79.84%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 34.95s
- Epoch 014, ExpID 77822
Train - Loss (one batch): 0.00276
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00612, 0.00612, 0.07822, 0.03801, 58.17%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 35.01s
- Epoch 015, ExpID 77822
Train - Loss (one batch): 0.00565
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00591, 0.00591, 0.07689, 0.03834, 111.78%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 35.04s
- Epoch 016, ExpID 77822
Train - Loss (one batch): 0.00479
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00584, 0.00584, 0.07639, 0.03687, 95.46%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 35.00s
- Epoch 017, ExpID 77822
Train - Loss (one batch): 0.00315
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00578, 0.00578, 0.07606, 0.03921, 119.70%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 35.01s
- Epoch 018, ExpID 77822
Train - Loss (one batch): 0.00194
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00586, 0.00586, 0.07655, 0.03775, 73.56%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00568, 0.00568, 0.07535, 0.03787, 95.22%
Time spent: 34.98s
Avg Train Time per epoch: 28.65s
Avg Inference Time per epoch: 0.07651s
Avg Peak GPU Mem (Train): 7060.4 MB
Peak GPU Mem (Inference): 5870.9 MB
