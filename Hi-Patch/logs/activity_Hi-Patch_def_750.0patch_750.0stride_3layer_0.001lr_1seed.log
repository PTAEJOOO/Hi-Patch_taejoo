/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-29 18:21:04
train_forecasting.py --dataset activity --state def --history 3000 --patience 10 --batch_size 32 --lr 1e-3 --patch_size 750 --stride 750 --nhead 1 --nlayer 3 --hid_dim 64 --seed 1 --gpu 0 --alpha 1
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=3000, pred_window=1000, logmode='a', lr=0.001, w_decay=0.0, batch_size=32, load=None, seed=1, dataset='activity', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=3, patch_size=750.0, stride=750.0, hid_dim=64, alpha=1.0, res=1, gpu='0', npatch=4, device=device(type='cuda', index=0), PID=1029760, ndim=12, patch_layer=3, scale_patch_size=0.1875, task='forecasting')
- Epoch 000, ExpID 48468
Train - Loss (one batch): 0.00264
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00370, 0.00370, 0.06086, 0.04081, 9.88%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00354, 0.00354, 0.05947, 0.04028, 8.82%
Time spent: 43.21s
- Epoch 001, ExpID 48468
Train - Loss (one batch): 0.00340
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00330, 0.00330, 0.05742, 0.03739, 9.17%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00316, 0.00316, 0.05620, 0.03703, 8.16%
Time spent: 42.76s
- Epoch 002, ExpID 48468
Train - Loss (one batch): 0.00277
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00311, 0.00311, 0.05576, 0.03443, 8.94%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 2, 0.00296, 0.00296, 0.05438, 0.03385, 7.93%
Time spent: 42.79s
- Epoch 003, ExpID 48468
Train - Loss (one batch): 0.00247
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00301, 0.00301, 0.05488, 0.03328, 8.59%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00286, 0.00286, 0.05352, 0.03270, 7.59%
Time spent: 42.79s
- Epoch 004, ExpID 48468
Train - Loss (one batch): 0.00331
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00313, 0.00313, 0.05599, 0.03482, 8.57%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00286, 0.00286, 0.05352, 0.03270, 7.59%
Time spent: 36.42s
- Epoch 005, ExpID 48468
Train - Loss (one batch): 0.00206
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00295, 0.00295, 0.05432, 0.03256, 8.34%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00281, 0.00281, 0.05305, 0.03216, 7.39%
Time spent: 42.77s
- Epoch 006, ExpID 48468
Train - Loss (one batch): 0.00202
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00316, 0.00316, 0.05624, 0.03638, 8.77%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00281, 0.00281, 0.05305, 0.03216, 7.39%
Time spent: 36.42s
- Epoch 007, ExpID 48468
Train - Loss (one batch): 0.00259
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00291, 0.00291, 0.05391, 0.03261, 8.42%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00277, 0.00277, 0.05267, 0.03201, 7.43%
Time spent: 42.78s
- Epoch 008, ExpID 48468
Train - Loss (one batch): 0.00210
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00289, 0.00289, 0.05375, 0.03239, 8.18%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00278, 0.00278, 0.05270, 0.03209, 7.31%
Time spent: 42.78s
- Epoch 009, ExpID 48468
Train - Loss (one batch): 0.00265
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00296, 0.00296, 0.05442, 0.03374, 8.74%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.00278, 0.00278, 0.05270, 0.03209, 7.31%
Time spent: 36.40s
- Epoch 010, ExpID 48468
Train - Loss (one batch): 0.00222
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00287, 0.00287, 0.05359, 0.03243, 8.36%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 10, 0.00277, 0.00277, 0.05262, 0.03217, 7.45%
Time spent: 42.79s
- Epoch 011, ExpID 48468
Train - Loss (one batch): 0.00256
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00296, 0.00296, 0.05438, 0.03448, 8.50%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 10, 0.00277, 0.00277, 0.05262, 0.03217, 7.45%
Time spent: 36.42s
- Epoch 012, ExpID 48468
Train - Loss (one batch): 0.00298
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00282, 0.00282, 0.05311, 0.03237, 8.16%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 12, 0.00273, 0.00273, 0.05224, 0.03213, 7.31%
Time spent: 42.78s
- Epoch 013, ExpID 48468
Train - Loss (one batch): 0.00183
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00283, 0.00283, 0.05320, 0.03289, 8.23%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 12, 0.00273, 0.00273, 0.05224, 0.03213, 7.31%
Time spent: 36.40s
- Epoch 014, ExpID 48468
Train - Loss (one batch): 0.00189
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00276, 0.00276, 0.05256, 0.03192, 8.28%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 14, 0.00268, 0.00268, 0.05178, 0.03192, 7.41%
Time spent: 42.78s
- Epoch 015, ExpID 48468
Train - Loss (one batch): 0.00310
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00282, 0.00282, 0.05307, 0.03309, 8.38%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 14, 0.00268, 0.00268, 0.05178, 0.03192, 7.41%
Time spent: 36.40s
- Epoch 016, ExpID 48468
Train - Loss (one batch): 0.00241
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00278, 0.00278, 0.05270, 0.03229, 8.48%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 14, 0.00268, 0.00268, 0.05178, 0.03192, 7.41%
Time spent: 36.41s
- Epoch 017, ExpID 48468
Train - Loss (one batch): 0.00323
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00276, 0.00276, 0.05255, 0.03205, 8.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 17, 0.00266, 0.00266, 0.05162, 0.03178, 7.24%
Time spent: 42.77s
- Epoch 018, ExpID 48468
Train - Loss (one batch): 0.00352
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00281, 0.00281, 0.05302, 0.03274, 8.24%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 17, 0.00266, 0.00266, 0.05162, 0.03178, 7.24%
Time spent: 36.40s
- Epoch 019, ExpID 48468
Train - Loss (one batch): 0.00250
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00270, 0.00270, 0.05200, 0.03181, 8.06%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 19, 0.00264, 0.00264, 0.05139, 0.03190, 7.26%
Time spent: 42.76s
- Epoch 020, ExpID 48468
Train - Loss (one batch): 0.00233
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00279, 0.00279, 0.05284, 0.03317, 8.28%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 19, 0.00264, 0.00264, 0.05139, 0.03190, 7.26%
Time spent: 36.41s
- Epoch 021, ExpID 48468
Train - Loss (one batch): 0.00280
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00295, 0.00295, 0.05436, 0.03541, 9.19%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 19, 0.00264, 0.00264, 0.05139, 0.03190, 7.26%
Time spent: 36.41s
- Epoch 022, ExpID 48468
Train - Loss (one batch): 0.00362
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00268, 0.00268, 0.05181, 0.03162, 8.14%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 22, 0.00262, 0.00262, 0.05115, 0.03171, 7.33%
Time spent: 42.75s
- Epoch 023, ExpID 48468
Train - Loss (one batch): 0.00327
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00268, 0.00268, 0.05177, 0.03151, 8.07%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 23, 0.00260, 0.00260, 0.05103, 0.03150, 7.24%
Time spent: 42.75s
- Epoch 024, ExpID 48468
Train - Loss (one batch): 0.00314
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00268, 0.00268, 0.05175, 0.03119, 8.04%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 24, 0.00260, 0.00260, 0.05101, 0.03121, 7.15%
Time spent: 42.77s
- Epoch 025, ExpID 48468
Train - Loss (one batch): 0.00229
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00269, 0.00269, 0.05185, 0.03192, 8.10%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 24, 0.00260, 0.00260, 0.05101, 0.03121, 7.15%
Time spent: 36.40s
- Epoch 026, ExpID 48468
Train - Loss (one batch): 0.00207
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00279, 0.00279, 0.05284, 0.03351, 8.65%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 24, 0.00260, 0.00260, 0.05101, 0.03121, 7.15%
Time spent: 36.41s
- Epoch 027, ExpID 48468
Train - Loss (one batch): 0.00270
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00266, 0.00266, 0.05158, 0.03159, 8.22%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 27, 0.00259, 0.00259, 0.05087, 0.03151, 7.32%
Time spent: 42.77s
- Epoch 028, ExpID 48468
Train - Loss (one batch): 0.00206
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00269, 0.00269, 0.05191, 0.03208, 8.20%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 27, 0.00259, 0.00259, 0.05087, 0.03151, 7.32%
Time spent: 36.42s
- Epoch 029, ExpID 48468
Train - Loss (one batch): 0.00270
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00264, 0.00264, 0.05139, 0.03135, 8.06%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00256, 0.00256, 0.05063, 0.03130, 7.26%
Time spent: 42.77s
- Epoch 030, ExpID 48468
Train - Loss (one batch): 0.00259
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00266, 0.00266, 0.05161, 0.03148, 8.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00256, 0.00256, 0.05063, 0.03130, 7.26%
Time spent: 36.40s
- Epoch 031, ExpID 48468
Train - Loss (one batch): 0.00243
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00269, 0.00269, 0.05185, 0.03213, 8.55%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 29, 0.00256, 0.00256, 0.05063, 0.03130, 7.26%
Time spent: 36.40s
- Epoch 032, ExpID 48468
Train - Loss (one batch): 0.00140
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00263, 0.00263, 0.05125, 0.03100, 8.03%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 32, 0.00255, 0.00255, 0.05053, 0.03108, 7.20%
Time spent: 42.77s
- Epoch 033, ExpID 48468
Train - Loss (one batch): 0.00166
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00272, 0.00272, 0.05211, 0.03223, 8.06%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 32, 0.00255, 0.00255, 0.05053, 0.03108, 7.20%
Time spent: 36.41s
- Epoch 034, ExpID 48468
Train - Loss (one batch): 0.00281
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00264, 0.00264, 0.05142, 0.03165, 8.31%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 32, 0.00255, 0.00255, 0.05053, 0.03108, 7.20%
Time spent: 36.38s
- Epoch 035, ExpID 48468
Train - Loss (one batch): 0.00148
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00262, 0.00262, 0.05121, 0.03122, 8.05%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 42.77s
- Epoch 036, ExpID 48468
Train - Loss (one batch): 0.00235
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00268, 0.00268, 0.05174, 0.03160, 8.28%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.37s
- Epoch 037, ExpID 48468
Train - Loss (one batch): 0.00230
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00267, 0.00267, 0.05170, 0.03174, 8.38%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.41s
- Epoch 038, ExpID 48468
Train - Loss (one batch): 0.00317
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00271, 0.00271, 0.05209, 0.03248, 8.20%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.41s
- Epoch 039, ExpID 48468
Train - Loss (one batch): 0.00164
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00269, 0.00269, 0.05184, 0.03224, 8.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.40s
- Epoch 040, ExpID 48468
Train - Loss (one batch): 0.00321
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00266, 0.00266, 0.05157, 0.03149, 8.18%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.39s
- Epoch 041, ExpID 48468
Train - Loss (one batch): 0.00216
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00265, 0.00265, 0.05147, 0.03175, 8.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.40s
- Epoch 042, ExpID 48468
Train - Loss (one batch): 0.00228
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00266, 0.00266, 0.05157, 0.03148, 8.11%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.42s
- Epoch 043, ExpID 48468
Train - Loss (one batch): 0.00215
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00265, 0.00265, 0.05148, 0.03147, 8.08%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.40s
- Epoch 044, ExpID 48468
Train - Loss (one batch): 0.00199
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00272, 0.00272, 0.05217, 0.03278, 8.80%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.41s
- Epoch 045, ExpID 48468
Train - Loss (one batch): 0.00207
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00265, 0.00265, 0.05149, 0.03145, 8.06%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 35, 0.00257, 0.00257, 0.05069, 0.03124, 7.18%
Time spent: 36.40s
Avg Train Time per epoch: 30.48s
Avg Inference Time per epoch: 0.17939s
Avg Peak GPU Mem (Train): 5370.0 MB
Peak GPU Mem (Inference): 3400.1 MB
