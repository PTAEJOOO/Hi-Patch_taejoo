/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-29 15:58:14
train_forecasting.py --dataset mimic --state def --history 24 --patience 10 --batch_size 8 --lr 1e-3 --patch_size 12 --stride 12 --nhead 1 --nlayer 1 --hid_dim 128 --seed 2 --gpu 0 --alpha 0.9
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=24, pred_window=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=8, load=None, seed=2, dataset='mimic', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=1, patch_size=12.0, stride=12.0, hid_dim=128, alpha=0.9, res=1, gpu='0', npatch=2, device=device(type='cuda', index=0), PID=1025537, ndim=96, patch_layer=2, scale_patch_size=0.25, task='forecasting')
- Epoch 000, ExpID 91988
Train - Loss (one batch): 0.00157
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01568, 0.01568, 0.12524, 0.07423, 127.99%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.01674, 0.01674, 0.12939, 0.07519, 148.75%
Time spent: 100.14s
- Epoch 001, ExpID 91988
Train - Loss (one batch): 0.00303
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01528, 0.01528, 0.12362, 0.07030, 115.83%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.01613, 0.01613, 0.12699, 0.07107, 130.74%
Time spent: 99.12s
- Epoch 002, ExpID 91988
Train - Loss (one batch): 0.00405
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01571, 0.01571, 0.12534, 0.07028, 88.52%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.01613, 0.01613, 0.12699, 0.07107, 130.74%
Time spent: 84.41s
- Epoch 003, ExpID 91988
Train - Loss (one batch): 0.00285
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01507, 0.01507, 0.12275, 0.06947, 92.71%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01613, 0.01613, 0.12701, 0.06999, 114.32%
Time spent: 99.02s
- Epoch 004, ExpID 91988
Train - Loss (one batch): 0.01388
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01573, 0.01573, 0.12542, 0.07198, 89.24%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01613, 0.01613, 0.12701, 0.06999, 114.32%
Time spent: 84.48s
- Epoch 005, ExpID 91988
Train - Loss (one batch): 0.00361
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01524, 0.01524, 0.12345, 0.07253, 137.58%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01613, 0.01613, 0.12701, 0.06999, 114.32%
Time spent: 84.44s
- Epoch 006, ExpID 91988
Train - Loss (one batch): 0.01171
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01490, 0.01490, 0.12206, 0.07060, 90.93%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 98.93s
- Epoch 007, ExpID 91988
Train - Loss (one batch): 0.00535
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01527, 0.01527, 0.12359, 0.07137, 95.75%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.50s
- Epoch 008, ExpID 91988
Train - Loss (one batch): 0.00309
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01497, 0.01497, 0.12234, 0.07094, 103.73%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.56s
- Epoch 009, ExpID 91988
Train - Loss (one batch): 0.02439
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01498, 0.01498, 0.12238, 0.06949, 103.73%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.41s
- Epoch 010, ExpID 91988
Train - Loss (one batch): 0.00789
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01531, 0.01531, 0.12373, 0.07130, 125.99%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.56s
- Epoch 011, ExpID 91988
Train - Loss (one batch): 0.00445
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01538, 0.01538, 0.12403, 0.06939, 92.22%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.46s
- Epoch 012, ExpID 91988
Train - Loss (one batch): 0.00246
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01514, 0.01514, 0.12305, 0.06839, 98.40%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.47s
- Epoch 013, ExpID 91988
Train - Loss (one batch): nan
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01546, 0.01546, 0.12433, 0.07334, 118.38%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.51s
- Epoch 014, ExpID 91988
Train - Loss (one batch): 0.00102
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01571, 0.01571, 0.12533, 0.06912, 84.62%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.48s
- Epoch 015, ExpID 91988
Train - Loss (one batch): 0.02474
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01577, 0.01577, 0.12557, 0.07153, 89.94%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.36s
- Epoch 016, ExpID 91988
Train - Loss (one batch): 0.00539
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01577, 0.01577, 0.12559, 0.06898, 93.53%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.01593, 0.01593, 0.12620, 0.07117, 110.26%
Time spent: 84.45s
Avg Train Time per epoch: 70.03s
Avg Inference Time per epoch: 0.01991s
Avg Peak GPU Mem (Train): 11930.5 MB
Peak GPU Mem (Inference): 9294.4 MB
