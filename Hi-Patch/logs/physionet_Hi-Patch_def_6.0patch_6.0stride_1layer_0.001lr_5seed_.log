/home/taejoo/dsl_lab/Hi-Patch_taejoo/Hi-Patch/train_forecasting.py
2025-08-27 16:27:36
train_forecasting.py --dataset physionet --state def --history 24 --patience 10 --batch_size 64 --lr 1e-3 --patch_size 6 --stride 6 --nhead 1 --nlayer 1 --hid_dim 64 --seed 5 --gpu 0 --alpha 1
Namespace(state='def', n=100000000, epoch=1000, patience=10, history=24, pred_window=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=64, load=None, seed=5, dataset='physionet', quantization=0.0, model='Hi-Patch', nhead=1, nlayer=1, patch_size=6.0, stride=6.0, hid_dim=64, alpha=1.0, res=1, gpu='0', npatch=4, device=device(type='cuda', index=0), PID=812644, ndim=41, patch_layer=3, scale_patch_size=0.125, task='forecasting')
- Epoch 000, ExpID 47540
Train - Loss (one batch): 0.00532
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00640, 0.00640, 0.08001, 0.04183, 143.80%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00661, 0.00661, 0.08131, 0.04274, 130.10%
Time spent: 46.20s
- Epoch 001, ExpID 47540
Train - Loss (one batch): 0.00727
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00609, 0.00609, 0.07804, 0.03995, 124.88%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00607, 0.00607, 0.07790, 0.04044, 113.36%
Time spent: 45.93s
- Epoch 002, ExpID 47540
Train - Loss (one batch): 0.00393
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00621, 0.00621, 0.07884, 0.03954, 99.13%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00607, 0.00607, 0.07790, 0.04044, 113.36%
Time spent: 38.57s
- Epoch 003, ExpID 47540
Train - Loss (one batch): 0.00817
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00636, 0.00636, 0.07977, 0.04404, 226.74%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00607, 0.00607, 0.07790, 0.04044, 113.36%
Time spent: 38.34s
- Epoch 004, ExpID 47540
Train - Loss (one batch): 0.00351
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00609, 0.00609, 0.07805, 0.03869, 73.23%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00607, 0.00607, 0.07790, 0.04044, 113.36%
Time spent: 38.30s
- Epoch 005, ExpID 47540
Train - Loss (one batch): 0.00309
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00600, 0.00600, 0.07743, 0.03944, 92.38%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00578, 0.00578, 0.07605, 0.03931, 87.16%
Time spent: 47.45s
- Epoch 006, ExpID 47540
Train - Loss (one batch): 0.00473
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00614, 0.00614, 0.07835, 0.04000, 146.01%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00578, 0.00578, 0.07605, 0.03931, 87.16%
Time spent: 40.39s
- Epoch 007, ExpID 47540
Train - Loss (one batch): 0.00484
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00589, 0.00589, 0.07675, 0.03765, 136.31%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00584, 0.00584, 0.07645, 0.03806, 134.49%
Time spent: 48.57s
- Epoch 008, ExpID 47540
Train - Loss (one batch): 0.00428
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00624, 0.00624, 0.07899, 0.03834, 74.11%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00584, 0.00584, 0.07645, 0.03806, 134.49%
Time spent: 40.43s
- Epoch 009, ExpID 47540
Train - Loss (one batch): 0.00389
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00606, 0.00606, 0.07785, 0.03911, 92.03%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00584, 0.00584, 0.07645, 0.03806, 134.49%
Time spent: 40.32s
- Epoch 010, ExpID 47540
Train - Loss (one batch): 0.00306
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00601, 0.00601, 0.07753, 0.03733, 66.21%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00584, 0.00584, 0.07645, 0.03806, 134.49%
Time spent: 40.03s
- Epoch 011, ExpID 47540
Train - Loss (one batch): 0.00546
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00595, 0.00595, 0.07715, 0.03879, 104.27%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00584, 0.00584, 0.07645, 0.03806, 134.49%
Time spent: 40.30s
- Epoch 012, ExpID 47540
Train - Loss (one batch): 0.00486
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00628, 0.00628, 0.07924, 0.04214, 171.94%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00584, 0.00584, 0.07645, 0.03806, 134.49%
Time spent: 40.73s
- Epoch 013, ExpID 47540
Train - Loss (one batch): 0.00515
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00575, 0.00575, 0.07582, 0.04005, 162.91%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 48.54s
- Epoch 014, ExpID 47540
Train - Loss (one batch): 0.00292
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00588, 0.00588, 0.07668, 0.03871, 116.84%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.58s
- Epoch 015, ExpID 47540
Train - Loss (one batch): 0.00343
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00589, 0.00589, 0.07673, 0.03807, 109.72%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.32s
- Epoch 016, ExpID 47540
Train - Loss (one batch): 0.00345
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00611, 0.00611, 0.07815, 0.03915, 70.02%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.05s
- Epoch 017, ExpID 47540
Train - Loss (one batch): 0.00365
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00589, 0.00589, 0.07675, 0.03679, 80.09%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.38s
- Epoch 018, ExpID 47540
Train - Loss (one batch): 0.00687
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00590, 0.00590, 0.07681, 0.03754, 99.22%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.72s
- Epoch 019, ExpID 47540
Train - Loss (one batch): 0.00441
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00579, 0.00579, 0.07612, 0.03733, 125.47%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.54s
- Epoch 020, ExpID 47540
Train - Loss (one batch): 0.00389
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00597, 0.00597, 0.07729, 0.03786, 82.81%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.58s
- Epoch 021, ExpID 47540
Train - Loss (one batch): 0.00410
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00622, 0.00622, 0.07888, 0.03947, 103.88%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.38s
- Epoch 022, ExpID 47540
Train - Loss (one batch): 0.00478
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00599, 0.00599, 0.07737, 0.03729, 81.04%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 39.92s
- Epoch 023, ExpID 47540
Train - Loss (one batch): 0.00641
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00593, 0.00593, 0.07703, 0.03712, 60.81%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00568, 0.00568, 0.07534, 0.04046, 163.32%
Time spent: 40.67s
Avg Train Time per epoch: 32.50s
Avg Inference Time per epoch: 0.17890s
Avg Peak GPU Mem (Train): 12732.0 MB
Peak GPU Mem (Inference): 10769.7 MB
